(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();class h{calculateRowSums(e){const t=Array(e[0].length).fill(0).map(()=>({sumValue:0,sumVoltorb:0})),r=Array(e[0].length).fill(0).map(()=>({sumValue:0,sumVoltorb:0}));for(let s=0;s<e.length;s++)for(let l=0;l<e[s].length;l++)r[s].sumValue+=e[s][l].value,t[l].sumValue+=e[s][l].value,e[s][l].voltorb&&(r[s].sumVoltorb++,t[l].sumVoltorb++);return[r,t]}calculateNum2s3s(e){let t=0;for(let r=0;r<e.length;r++)for(let s=0;s<e[r].length;s++)e[r][s].value>1&&t++;return t}}const a=5,d={1:[[5,0,6],[4,1,6],[3,1,6],[2,2,6],[0,3,6]],2:[[6,0,7],[5,1,7],[3,2,7],[1,3,7],[0,4,7]],3:[[7,0,8],[6,1,8],[4,2,8],[2,3,8],[1,4,8]],4:[[8,0,10],[5,2,10],[3,3,8],[2,4,10],[0,5,8]],5:[[9,0,10],[7,1,10],[6,2,10],[4,3,10],[1,5,10]],6:[[8,1,10],[5,3,10],[3,4,10],[2,5,10],[0,6,10]],7:[[9,1,13],[7,2,10],[6,3,10],[4,4,10],[1,6,13]],8:[[0,7,10],[8,2,10],[5,4,10],[2,6,10],[7,3,10]]};class f{constructor(e,t,r){this.boardGenerator=e,this.boardCalculator=t,this.boardListener=r,this.grid=[],this.activeTile=null,this.rowSums=[],this.colSums=[],this.level=1,this.gameOver=!1,this.memoMode=!1,this.totalCoins=0,this.coinsThisLevel=0,this.num2s3s=0;const s=d[this.level.toString()][Math.floor(Math.random()*5)];this.grid=this.boardGenerator.generateBoard(s,a),[this.rowSums,this.colSums]=this.boardCalculator.calculateRowSums(this.grid),this.num2s3s=this.boardCalculator.calculateNum2s3s(this.grid),this.renderMemoButton(),this.renderNumberButtons()}resetBoard(){this.gameOver=!1,this.coinsThisLevel=0,this.num2s3s=0;const e=d[this.level.toString()][Math.floor(Math.random()*5)];this.grid=this.boardGenerator.generateBoard(e,a),[this.rowSums,this.colSums]=this.boardCalculator.calculateRowSums(this.grid),this.num2s3s=this.boardCalculator.calculateNum2s3s(this.grid)}renderGame(){this.renderBoard(),this.renderInfo()}renderBoard(){const e=document.getElementById("game-board");e.innerHTML="";const t=this.grid,r=this.rowSums,s=this.colSums;for(let l=0;l<=a;l++)for(let o=0;o<=a;o++){const i=document.createElement("div");l===5&&o===5?i.className="empty-tile":l===5||o===5?this.renderInfoTile(i,r,s,l,o):this.renderGameTile(i,t[l][o]),e==null||e.appendChild(i)}}renderInfoTile(e,t,r,s,l){e.className="info-tile",s===5?e.textContent=`Sum: 0${r[l].sumValue}
ðŸ’£:${r[l].sumVoltorb}`:l===5&&(e.textContent=`Sum: 0${t[s].sumValue}
ðŸ’£:${t[s].sumVoltorb}`)}renderGameTile(e,t){e.className="game-tile",this.memoMode&&t.selected&&(this.activeTile=t,e.classList.add("active"));const r=Array.from(t.marks).sort(),s=r.length>0?`[${r.join(",")}]`:"";e.textContent=t.revealed?t.voltorb?"ðŸ’£":t.value.toString()+`
`+s:""+s,e.addEventListener("click",()=>this.boardListener.gameTileClickListener(this,t))}renderInfo(){const e=document.getElementById("info-level");e.textContent=`Level: 
${this.level}`;const t=document.getElementById("info-coins");t.textContent=`Total coins: 
${this.totalCoins}`;const r=document.getElementById("info-coins-level");r.textContent=`Coins this level: 
${this.coinsThisLevel}`}renderMemoButton(){const e=document.getElementById("memo-button-toggle");e==null||e.addEventListener("click",()=>{this.toggleMemoMode(),e.textContent=this.memoMode?"Memo Mode: ON":"Memo Mode: OFF",document.querySelectorAll(".game-tile").forEach(r=>{r.classList.remove("active")}),this.renderGame()})}renderNumberButtons(){const e=document.getElementById("memo-button-0");e==null||e.addEventListener("click",()=>{this.boardListener.numberButtonClickListener(this,0)});const t=document.getElementById("memo-button-1");t==null||t.addEventListener("click",()=>{this.boardListener.numberButtonClickListener(this,1)});const r=document.getElementById("memo-button-2");r==null||r.addEventListener("click",()=>{this.boardListener.numberButtonClickListener(this,2)});const s=document.getElementById("memo-button-3");s==null||s.addEventListener("click",()=>{this.boardListener.numberButtonClickListener(this,3)})}toggleMemoMode(){this.memoMode=!this.memoMode}}class g{generateBoard(e,t){const[r,s,l]=e,o=t*t-r-s-l,i=[...this.createTileArray(l,0),...this.createTileArray(o,1),...this.createTileArray(r,2),...this.createTileArray(s,3)];for(let n=i.length-1;n>=0;n--){const u=Math.floor(Math.random()*(n+1));[i[n],i[u]]=[i[u],i[n]]}const m=[];for(let n=0;n<t;n++)m.push(i.slice(n*t,(n+1)*t));return console.log(m),m}createTileArray(e,t){return Array(e).fill(t).map(r=>this.createTile(r))}createTile(e){return{voltorb:e===0,value:e,revealed:!1,selected:!1,marks:new Set}}}class v{numberButtonClickListener(e,t){const r=e.activeTile;r!=null&&(r.marks.has(t)?r.marks.delete(t):r.marks.add(t)),e.renderGame()}gameTileClickListener(e,t){e.gameOver?e.resetBoard():e.memoMode?(e.grid.flat().forEach(r=>{r.selected=!1}),t.selected=!0):this.revealTile(e,t),e.renderGame()}revealTile(e,t){t.revealed=!0,t.voltorb?this.triggerGameOver(e):(t.value>1&&e.num2s3s--,e.coinsThisLevel=e.coinsThisLevel>0?e.coinsThisLevel*t.value:t.value),this.isGamecomplete(e)&&this.triggerGameComplete(e)}isGamecomplete(e){return e.num2s3s===0}triggerGameOver(e){e.gameOver=!0,alert("Game over!"),this.flipBoard(!0,e),e.level=e.level>1?e.level-1:1}triggerGameComplete(e){e.gameOver=!0,alert("You won!"),this.flipBoard(!0,e),e.totalCoins+=e.coinsThisLevel,e.level++}flipBoard(e,t){t.grid.forEach(s=>{s.forEach(l=>{l.revealed=e})})}}const L=new g,B=new h,y=new v,p=new f(L,B,y);p.renderGame();
