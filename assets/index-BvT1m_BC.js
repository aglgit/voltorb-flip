(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();class S{calculateRowSums(e){const t=Array(e[0].length).fill(0).map(()=>({sumValue:0,sumVoltorb:0})),o=Array(e[0].length).fill(0).map(()=>({sumValue:0,sumVoltorb:0}));for(let s=0;s<e.length;s++)for(let r=0;r<e[s].length;r++)o[s].sumValue+=e[s][r].value,t[r].sumValue+=e[s][r].value,e[s][r].voltorb&&(o[s].sumVoltorb++,t[r].sumVoltorb++);return[o,t]}calculateNum2s3s(e){let t=0;for(let o=0;o<e.length;o++)for(let s=0;s<e[o].length;s++)e[o][s].value>1&&t++;return t}}class f{generateBoard(e,t){const[o,s,r]=e,a=t*t-o-s-r,l=[...this.createTileArray(r,0),...this.createTileArray(a,1),...this.createTileArray(o,2),...this.createTileArray(s,3)];for(let d=l.length-1;d>=0;d--){const h=Math.floor(Math.random()*(d+1));[l[d],l[h]]=[l[h],l[d]]}const c=[];for(let d=0;d<t;d++)c.push(l.slice(d*t,(d+1)*t));return console.log(c),c}createTileArray(e,t){return Array(e).fill(t).map(o=>this.createTile(o))}createTile(e){return{voltorb:e===0,value:e,revealed:!1,marks:new Set}}}const i=5;class g{constructor(e){this.boardState=e}gameTileMarkListener(e){const t=this.boardState.selectedTile;this.toggleMark(t,e)}gameTileRevealListener(e,t,o){this.boardState.gameOver?this.boardState.resetBoard():this.boardState.memoMode?(this.boardState.selectedTile=e,this.boardState.selectedRow=t,this.boardState.selectedCol=o):(this.boardState.selectedTile=e,this.boardState.selectedRow=t,this.boardState.selectedCol=o,this.revealTile(e))}keyPressListener(e){switch(e.key){case"ArrowUp":e.preventDefault(),this.boardState.selectedRow>0&&(this.boardState.selectedRow--,this.boardState.selectedTile=this.boardState.grid[this.boardState.selectedRow][this.boardState.selectedCol]);break;case"ArrowDown":e.preventDefault(),this.boardState.selectedRow<i-1&&(this.boardState.selectedRow++,this.boardState.selectedTile=this.boardState.grid[this.boardState.selectedRow][this.boardState.selectedCol]);break;case"ArrowLeft":e.preventDefault(),this.boardState.selectedCol>0&&(this.boardState.selectedCol--,this.boardState.selectedTile=this.boardState.grid[this.boardState.selectedRow][this.boardState.selectedCol]);break;case"ArrowRight":e.preventDefault(),this.boardState.selectedCol<i-1&&(this.boardState.selectedCol++,this.boardState.selectedTile=this.boardState.grid[this.boardState.selectedRow][this.boardState.selectedCol]);break;case"Enter":this.gameTileRevealListener(this.boardState.selectedTile,this.boardState.selectedRow,this.boardState.selectedCol);break;case"x":case"X":this.boardState.toggleMemoMode();break;case"0":case"1":case"2":case"3":{const t=this.boardState.selectedTile,o=parseInt(e.key);this.toggleMark(t,o);break}}}toggleMark(e,t){e&&(e.marks.has(t)?e.marks.delete(t):e.marks.add(t))}revealTile(e){e.revealed=!0,e.voltorb?this.triggerGameOver():(e.value>1&&this.boardState.num2s3s--,this.boardState.coinsThisLevel=this.boardState.coinsThisLevel>0?this.boardState.coinsThisLevel*e.value:e.value),this.isGamecomplete()&&this.triggerGameComplete()}isGamecomplete(){return this.boardState.num2s3s===0}triggerGameOver(){this.boardState.gameOver=!0,alert("Game over!"),this.flipBoard(!0),this.boardState.level=this.boardState.level>1?this.boardState.level-1:1}triggerGameComplete(){this.boardState.gameOver=!0,alert("You won!"),this.flipBoard(!0),this.boardState.totalCoins+=this.boardState.coinsThisLevel,this.boardState.level++}flipBoard(e){this.boardState.grid.forEach(o=>{o.forEach(s=>{s.revealed=e})})}}class v{constructor(e,t){this.boardListener=e,this.boardState=t}firstRenderGame(){this.renderInfo(),this.renderBoard(),this.renderMemoButton(),this.addEventListeners()}renderGame(){this.renderInfo(),this.renderBoard(),this.renderMemoButton()}renderInfo(){const e=document.getElementById("info-level");e.textContent=`Level: 
${this.boardState.level}`;const t=document.getElementById("info-coins");t.textContent=`Total coins: 
${this.boardState.totalCoins}`;const o=document.getElementById("info-coins-level");o.textContent=`Coins this level: 
${this.boardState.coinsThisLevel}`}renderBoard(){const e=document.getElementById("game-board");e.innerHTML="";const t=this.boardState.grid,o=this.boardState.rowSums,s=this.boardState.colSums;for(let r=0;r<=i;r++)for(let a=0;a<=i;a++){const l=document.createElement("div");r===i&&a===i?l.className="empty-tile":r===i||a===i?this.renderInfoTile(l,o,s,r,a):this.renderGameTile(l,t[r][a],r,a),e==null||e.appendChild(l)}}renderInfoTile(e,t,o,s,r){e.className="info-tile",s===i?e.textContent=`Sum: 0${o[r].sumValue}
ðŸ’£:${o[r].sumVoltorb}`:r===i&&(e.textContent=`Sum: 0${t[s].sumValue}
ðŸ’£:${t[s].sumVoltorb}`)}renderGameTile(e,t,o,s){e.className="game-tile",t==this.boardState.selectedTile&&this.boardState.memoMode?e.classList.add("selected-memo"):t==this.boardState.selectedTile&&e.classList.add("selected");const r=Array.from(t.marks).sort(),a=r.length>0?`[${r.join(",")}]`:"";e.textContent=t.revealed?t.voltorb?"ðŸ’£":t.value.toString()+`
`+a:""+a,e.addEventListener("click",()=>{this.boardListener.gameTileRevealListener(t,o,s),this.renderGame()})}renderMemoButton(){const e=document.getElementById("memo-button-toggle");e.textContent=this.boardState.memoMode?"Memo Mode: ON":"Memo Mode: OFF"}addEventListeners(){document.addEventListener("keydown",a=>{this.boardListener.keyPressListener(a),this.renderGame()});const e=document.getElementById("memo-button-toggle");e.textContent=this.boardState.memoMode?"Memo Mode: ON":"Memo Mode: OFF",e==null||e.addEventListener("click",()=>{this.boardState.toggleMemoMode(),this.renderGame()});const t=document.getElementById("memo-button-0");t==null||t.addEventListener("click",()=>{this.boardListener.gameTileMarkListener(0),this.renderGame()});const o=document.getElementById("memo-button-1");o==null||o.addEventListener("click",()=>{this.boardListener.gameTileMarkListener(1),this.renderGame()});const s=document.getElementById("memo-button-2");s==null||s.addEventListener("click",()=>{this.boardListener.gameTileMarkListener(2),this.renderGame()});const r=document.getElementById("memo-button-3");r==null||r.addEventListener("click",()=>{this.boardListener.gameTileMarkListener(3),this.renderGame()})}}const m=5,u={1:[[5,0,6],[4,1,6],[3,1,6],[2,2,6],[0,3,6]],2:[[6,0,7],[5,1,7],[3,2,7],[1,3,7],[0,4,7]],3:[[7,0,8],[6,1,8],[4,2,8],[2,3,8],[1,4,8]],4:[[8,0,10],[5,2,10],[3,3,8],[2,4,10],[0,5,8]],5:[[9,0,10],[7,1,10],[6,2,10],[4,3,10],[1,5,10]],6:[[8,1,10],[5,3,10],[3,4,10],[2,5,10],[0,6,10]],7:[[9,1,13],[7,2,10],[6,3,10],[4,4,10],[1,6,13]],8:[[0,7,10],[8,2,10],[5,4,10],[2,6,10],[7,3,10]]};class L{constructor(e,t){this.boardGenerator=e,this.boardCalculator=t,this.level=1,this.gameOver=!1,this.memoMode=!1,this.totalCoins=0,this.coinsThisLevel=0;const o=u[this.level.toString()][Math.floor(Math.random()*m)];this.grid=this.boardGenerator.generateBoard(o,i),this.selectedTile=this.grid[0][0],this.selectedRow=0,this.selectedCol=0,[this.rowSums,this.colSums]=this.boardCalculator.calculateRowSums(this.grid),this.num2s3s=this.boardCalculator.calculateNum2s3s(this.grid)}resetBoard(){this.gameOver=!1,this.coinsThisLevel=0;const e=u[this.level.toString()][Math.floor(Math.random()*m)];this.grid=this.boardGenerator.generateBoard(e,i),this.selectedTile=this.grid[0][0],this.selectedRow=0,this.selectedCol=0,[this.rowSums,this.colSums]=this.boardCalculator.calculateRowSums(this.grid),this.num2s3s=this.boardCalculator.calculateNum2s3s(this.grid)}toggleMemoMode(){this.memoMode=!this.memoMode}}const T=new f,M=new S,b=new L(T,M),p=new g(b),w=new v(p,b);w.firstRenderGame();
